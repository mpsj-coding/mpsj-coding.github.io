var A=[[0,1,1,1,0],[1,0,0,0,1],[1,1,1,1,1],[1,0,0,0,1],[1,0,0,0,1]],B=[[1,1,1,1,0],[1,0,0,0,1],[1,1,1,1,0],[1,0,0,0,1],[1,1,1,1,0]],C=[[1,1,1,1,1],[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,1,1,1,1]],D=[[1,1,1,1,0],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,0]],E=[[1,1,1,1,1],[1,0,0,0,0],[1,1,1,1,1],[1,0,0,0,0],[1,1,1,1,1]],F=[[1,1,1,1,1],[1,0,0,0,0],[1,1,1,1,1],[1,0,0,0,0],[1,0,0,0,0]],G=[[1,1,1,1,1],[1,0,0,0,0],[1,0,0,1,1],[1,0,0,0,1],[1,1,1,1,1]],H=[[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,1],[1,0,0,0,1],[1,0,0,0,1]],I=[[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1]],J=[[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0],[1,0,1,0,0],[1,1,1,0,0]],K=[[1,0,0,1,0],[1,0,1,0,0],[1,1,0,0,0],[1,0,1,0,0],[1,0,0,1,0]],L=[[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,1,1,1,1]],M=[[1,0,0,0,1],[1,1,0,1,1],[1,0,1,0,1],[1,0,0,0,1],[1,0,0,0,1]],N=[[1,0,0,0,1],[1,1,0,0,1],[1,0,1,0,1],[1,0,0,1,1],[1,0,0,0,1]],O=[[0,1,1,1,0],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[0,1,1,1,0]],P=[[1,1,1,1,0],[1,0,0,0,1],[1,1,1,1,0],[1,0,0,0,0],[1,0,0,0,0]],Q=[[0,1,1,1,0],[1,0,0,0,1],[1,0,1,0,1],[1,0,0,1,1],[0,1,1,1,0]],R=[[1,1,1,1,1],[1,0,0,0,1],[1,0,1,1,0],[1,0,0,1,0],[1,0,0,0,1]],S=[[0,1,1,1,1],[1,0,0,0,0],[0,1,1,1,0],[0,0,0,0,1],[1,1,1,1,0]],T=[[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0]],U=[[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[0,1,1,1,0]],V=[[1,0,0,0,1],[1,0,0,0,1],[0,1,0,1,0],[0,1,0,1,0],[0,0,1,0,0]],W=[[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1],[1,0,1,0,1],[0,1,1,1,0]],X=[[1,0,0,0,1],[0,1,0,1,0],[0,0,1,0,0],[0,1,0,1,0],[1,0,0,0,1]],Y=[[1,0,0,0,1],[0,1,0,1,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0]],Z=[[1,1,1,1,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,1,1,1,1]],dot=[[0,0,0,0,0],[0,0,0,0,0],[0,1,1,1,0],[0,1,1,1,0],[0,1,1,1,0]],exclamation=[[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,0,0,0],[0,0,1,0,0]],ms={A:A,B:B,C:C,D:D,E:E,F:F,G:G,H:H,I:I,J:J,K:K,L:L,M:M,N:N,O:O,P:P,Q:Q,R:R,S:S,T:T,U:U,V:V,W:W,X:X,Y:Y,Z:Z,".":dot,"!":exclamation},blobCount={};!function(t){function s(t){if(t=t.toUpperCase(),"undefined"!=typeof blobCount[t])return blobCount[t];var s=0;for(i=0;i<ms[t].length;i++)for(j=0;j<ms[t][i].length;j++)1==ms[t][i][j]&&s++;return blobCount[t]=s,s}function e(t,s,e){var o=[];for(i=1;i<6;i++)for(o[i-1]=[],j=1;j<6;j++)o[i-1][j-1]=t.matrix[i][j];for(i=0;i<5;i++)for(j=0;j<5;j++)if(s[i][j]){var h=!1;for(x=0;x<5;x++){for(y=0;y<5;y++)if(o[x][y]){switch(t.animation){case"spiral":t.SpiralTo(x+1+"_"+(y+1),i+1,j+1);break;case"contract":t.MoveTo(x+1+"_"+(y+1),3,3);break;case"fade":t.FadeTo(x+1+"_"+(y+1),i+1,j+1);break;case"flow":t.flowTo(x+1+"_"+(y+1),i+1,j+1);break;default:t.MoveTo(x+1+"_"+(y+1),i+1,j+1)}o[x][y]=!1,h=!0;break}if(h)break}}"contract"==t.animation&&setTimeout(function(){var i=0,e=0;for(i=0;5>i;i++)for(e=0;5>e;e++)s[i][e]&&t.MoveTo("3_3",i+1,e+1)},1e3),"function"==typeof e&&setTimeout(e,1e3)}function o(t,i,s,e,r,a){if("undefined"!=typeof a&&t.y<i.y&&(r=-1),1>s)return t.elem.css("top",i.y+"px"),void t.elem.css("left",i.x+"px");var n=s*s-(t.x-i.x)*(t.x-i.x);return n=Math.sqrt(n),isNaN(n)?(e*=-1,r*=-1,t.x=t.x+4*e,n=s*s-(t.x-i.x)*(t.x-i.x),n=Math.sqrt(n)):t.x=t.x+2*e,t.y=i.y+r*n,isNaN(t.y)?(t.elem.css("top",i.y+"px"),void t.elem.css("left",i.x+"px")):(t.elem.css("top",t.y+"px"),t.elem.css("left",t.x+"px"),void setTimeout(function(){o(t,i,s-1,e,r)},h))}var h=10,r={},a=function(t,e){for(this.InitVariables(),this.elem=t,this["char"]=e["char"],this.char_x=this["char"],this.hash=Math.floor(1e4*Math.random())%5e3;"undefined"!=typeof r[this.hash];)this.hash=Math.floor(1e4*Math.random())%5e3;this.elem.attr("hash",this.hash),"undefined"!=typeof e.height&&parseInt(e.height)>0&&(this.height=parseInt(e.height),this.blobHeight=parseInt(e.height)/5),"undefined"!=typeof e.width&&parseInt(e.width)>0&&(this.width=parseInt(e.width),this.blobWidth=parseInt(e.width)/5),"undefined"!=typeof e.background&&(this.background=e.background),"undefined"!=typeof e.border&&(this.border=e.border),"undefined"!=typeof e.timeout&&(this.timeout=e.timeout,console.log("timeout ",this.timeout)),"undefined"!=typeof e.animation&&(this.animation=e.animation),"function"==typeof e.success?this.success=e.success:"undefined"!=typeof e.success&&console.error("[digitalwrite - error] {options.success} should be a function");var o=this.elem.offset();for(this.startX=o.left,this.startY=o.top,this.elem.css("position","relative"),this.elem.css("height",this.height+"px"),this.elem.css("width",this.width+"px"),this.req=s(e["char"]),this.matrix=[],i=0;i<7;i++)for(this.matrix[i]=[],j=0;j<7;j++)0==i||0==j||6==i||6==j?this.matrix[i][j]=1:this.matrix[i][j]=0;if("none"==this.animation){for(i=0;i<5;i++)for(j=0;j<5;j++)ms[this["char"]][i][j]&&(this.createElement(i,j),this.create++,this.matrix[i+1][j+1]=1);return void(null!=this.success&&this.success())}this.create=1,this.matrix[3][3]=1,this.createElement(3,3);var h=this;setTimeout(function(){h.Spread(3,3)},this.timeout)};a.prototype.GetPosition=function(t,i){return{x:i*this.blobWidth,y:t*this.blobHeight}},a.prototype.createElement=function(i,s){var e=this.GetPosition(i,s),o=document.createElement("div");return t(o).addClass("dwelem"),t(o).attr("pos",this.char_x+this.hash+"_"+i+"_"+s),this.matrix[i][s]++,t(o).css("display","inline-block"),t(o).css("position","absolute"),t(o).css("transition","top .2s, left .2s"),t(o).css("top",e.y+"px").css("left",e.x+"px"),t(o).css("width",this.blobWidth+"px").css("height",this.blobHeight+"px"),t(o).css("background-color",this.background),t(o).css("border",this.border),this.elem.append(o),o},a.prototype.deleteBlobs=function(s){var e=ms[this["char"]];for(i=0;i<ms[this["char"]].length;i++)for(j=0;j<ms[this["char"]][i].length;j++)if(1==ms[this["char"]][i][j]){var o=i+1+"_"+(j+1),h=t(".dwelem[pos='"+this.char_x+this.hash+"_"+o+"']").eq(0);if(h.remove(),e[i][j]=0,--s,0==s)return e}return e},a.prototype.createBlobs=function(t){var i,s,e=ms[this["char"]],o=[],h=t;for(i=0;i<ms[this["char"]].length;i++){for(s=0;s<ms[this["char"]][i].length&&(1!=ms[this["char"]][s][i]||(o.push({i:i,j:s}),--h,0!=h));s++);if(0==h)break}if(h)for(;h--;)o.push(o[o.length-1]);for(var i=0;i<ms[this["char"]].length;i++)for(var s=0;s<ms[this["char"]][i].length;s++)if(0==ms[this["char"]][i][s]){var r=o.pop();if(this.createElement(r.i+1,r.j+1),this.MoveTo(r.i+1+"_"+(r.j+1),i+1,s+1),e[i][s]=1,--t,0==t)return e}return e},a.prototype.transformTo=function(i,e){var o,h,r=s(this["char"]),a=s(i),n=ms[this["char"]];for(r>a?n=this.deleteBlobs(r-a):a>r&&(n=this.createBlobs(a-r)),o=1;6>o;o++)for(h=1;6>h;h++)this.matrix[o][h]=n[o-1][h-1];for(var c=[],o=0;o<ms[this["char"]].length;o++)c[o]=[0,0,0,0,0];this.elem.children(".dwelem").each(function(){var i=t(this).attr("pos").split("_");c[parseInt(i[1])-1][parseInt(i[2])-1]=1});var f=[];for(o=0;5>o;o++)for(h=0;5>h;h++)!ms[i][o][h]&&c[o][h]&&f.push({i:o,j:h});for(o=0;5>o;o++)for(h=0;5>h;h++)if(ms[i][o][h]&&!c[o][h]){var l=f.pop();this.MoveTo(l.i+1+"_"+(l.j+1),o+1,h+1)}this.char_x=i+this.char_x,this.elem.children(".dwelem").each(function(){var s=t(this).attr("pos");s=i+s.substr(0,s.length),t(this).attr("pos",s)}),"function"==typeof e&&setTimeout(e,1e3)},a.prototype.MoveTo=function(i,s,e){var o=i.split("_");this.matrix[parseInt(o[0])][parseInt(o[1])]--,this.matrix[s][e]++;var h=t(".dwelem[pos='"+this.char_x+this.hash+"_"+i+"']").eq(0);h.attr("pos",this.char_x+this.hash+"_"+s+"_"+e);var r=this.GetPosition(s,e);h.css("top",r.y+"px"),setTimeout(function(){h.css("left",r.x+"px")},500)},a.prototype.FadeTo=function(i,s,e){var o=i.split("_");this.matrix[parseInt(o[0])][parseInt(o[1])]--,this.matrix[s][e]++;var h=t(".dwelem[pos='"+this.char_x+this.hash+"_"+i+"']").eq(0);h.fadeOut(),h.attr("pos",this.char_x+this.hash+"_"+s+"_"+e);var r=this.GetPosition(s,e);h.css("top",r.y+"px"),h.css("left",r.x+"px"),setTimeout(function(){h.fadeIn()},this.timeout)},a.prototype.SpiralTo=function(i,s,e){var h=t(".dwelem[pos='"+this.char_x+this.hash+"_"+i+"']").eq(0);h.css("transition","none");var r=i.split("_");r=this.GetPosition(r[0],r[1]),r.elem=h;var a=this.GetPosition(s,e),n=Math.sqrt((r.x-a.x)*(r.x-a.x)+(r.y-a.y)*(r.y-a.y)),c=this;setTimeout(function(){h.attr("pos",c.char_x+c.hash+"_"+s+"_"+e),o(r,a,n,-1,1,!0)},500)},a.prototype.flowTo=function(i,s,e){var o=t(".dwelem[pos='"+this.char_x+this.hash+"_"+i+"']").eq(0);o.css("transition","width .5s ease-out, height .5s ease-out, top .5s ease-out, left .5 ease-out");var h=i.split("_");h=this.GetPosition(h[0],h[1]);var r=this.GetPosition(s,e),a=Math.abs(r.x-h.x);r.x<h.x&&o.css("left",r.x+"px"),o.css("width",a+"px");var n=this;setTimeout(function(){o.css("width",n.blobWidth+"px"),o.css("left",r.x+"px");var t=Math.abs(r.y-h.y);r.y<h.y&&o.css("top",r.y+"px"),o.css("height",t+"px"),setTimeout(function(){o.css("height",n.blobHeight+"px"),o.css("top",r.y+"px"),o.attr("pos",n.char_x+n.hash+"_"+s+"_"+e)},n.timeout)},this.timeout)},a.prototype.Spread=function(t,i){if(this.create==this.req)return void("undefined"==typeof this.alphabetised&&(this.alphabetised=!0,e(this,ms[this["char"]],this.success)));var s=null,o=null,h=!1;if(Math.random()>.5)for(x=t-1;x<=t+1;x++){for(y=i-1;y<=i+1;y++)if(!this.matrix[x][y]){if(null!=s){o={x:x,y:y},h=!0;break}s={x:x,y:y}}if(h)break}else for(x=t+1;x>=t-1;x--){for(y=i+1;y>=i-1;y--)if(!this.matrix[x][y]){if(null!=s){o={x:x,y:y},h=!0;break}s={x:x,y:y}}if(h)break}if(null!=s){if(this.createElement(t,i),this.MoveTo(t+"_"+i,s.x,s.y),this.matrix[s.x][s.y]=1,this.create++,this.create!=this.req){null!=o&&(this.MoveTo(t+"_"+i,o.x,o.y),this.matrix[t][i]=0,this.matrix[o.x][o.y]=1);var r=this;setTimeout(function(){r.Spread(s.x,s.y),null!=o?r.Spread(o.x,o.y):r.Spread(t,i)},this.timeout)}}},a.prototype.InitVariables=function(){this["char"]=null,this.char_x=null,this.elem=null,this.timeout=1e3,this.width=100,this.height=100,this.startX=0,this.startY=0,this.hash=null,this.blobWidth=20,this.blobHeight=20,this.req=0,this.create=0,this.background="rgba(0, 0, 0, 1)",this.border="1px dashed black",this.animation="motion",this.success=null},t.fn.digitalwrite=function(i){return"string"!=typeof i["char"]?void console.log("[digitial-write plugin] Charecter not specified or invalid format"):void(0!=t(this).length&&t(this).each(function(){t(this).data("obj",new a(t(this),i))}))},t.fn.transformTo=function(i,s){return"undefined"==typeof i?void console.log("[digitial-write plugin] Charecter not specified or invalid format"):void(0!=t(this).length&&t(this).each(function(){var e=t(this).data("obj");"undefined"==typeof e&&t(this).digitalwrite({"char":i}),e.transformTo(i,s)}))}}(jQuery);